<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
 "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<!-- Generated by IDLdoc 3.6.1 on Sun Mar 18 21:49:08 2018 -->

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html;charset=utf-8"/>
    <title>jwst_dither_to_sam.pro (Documentation for /Users/penton/JWST/pro/)</title>

    
    <link rel="stylesheet" type="text/css" media="all"
          href="idldoc-resources/main.css" />
    <link rel="stylesheet" type="text/css" media="print"
          href="idldoc-resources/main-print.css" />
    

    <script type="text/javascript">
      function setTitle() {
        parent.document.title="jwst_dither_to_sam.pro (Documentation for /Users/penton/JWST/pro/)";
      }
    </script>
  </head>

  <body onload="setTitle();" id="root">
    <div class="content">
      <code class="source"><span class="comments">;+</span>
<span class="comments">; Given a DITHER for a particular Science Instrument (SI) and APERTURE NAME (APERNAME), convert this to a SAM</span>
<span class="comments">;</span>
<span class="comments">; Small Angle Maneuvers (SAMs) are always in [V2,V3] arcseconds in the FGS frame.</span>
<span class="comments">; This can be either FGS1 (Guider1) or FGS2 (Guider2).</span>
<span class="comments">;</span>
<span class="comments">; :Author:</span>
<span class="comments">;    Steven V. Penton</span>
<span class="comments">;</span>
<span class="comments">; Keywords:</span>
<span class="comments">;	dither: in, required, type=double array (2)</span>
<span class="comments">;     A dither tuple in the arcseconds in the reference frame of the given SI and APERNAME</span>
<span class="comments">;</span>
<span class="comments">;	si: in, required, string</span>
<span class="comments">; 		The Science Instrument, must be one of</span>
<span class="comments">;                NRC | Nircam</span>
<span class="comments">;                NRS | Nirspec</span>
<span class="comments">;                NIR | Niriss</span>
<span class="comments">;                MIR | MIRI</span>
<span class="comments">;                FGS</span>
<span class="comments">;		NOT case-sensitive</span>
<span class="comments">;</span>
<span class="comments">;	apername: in, required, string</span>
<span class="comments">;			Must be a valid Aperture Name for the SI in question</span>
<span class="comments">;    verbose : in, optional, type=boolean</span>
<span class="comments">;       if set, print informational messages</span>
<span class="comments">;    debug : in, optional, type=boolean</span>
<span class="comments">;       if set, output debugging information</span>
<span class="comments">;    redo : in, optional, type=boolean, default = NO (0)</span>
<span class="comments">;       if set, re-create the siaf file for the given SI</span>
<span class="comments">;    out_apername : in, optional, type=string</span>
<span class="comments">;       if set, overrides the default of 'FGS1_FULL_OSS'</span>
<span class="comments">;    out_si : in, optional, type=string</span>
<span class="comments">;       if set, overrides the default of 'FGS'</span>
<span class="comments">;-</span>

<a id="jwst_dither_to_sam:source"></a>function jwst_dither_to_sam,dither,si,apername,verbose=verbose,debug=debug,redo=redo,$
	out_apername=out_apername,out_si=out_si
	if n_elements(out_si) ne 1 then out_si='FGS'
	if n_elements(out_apername) ne 1 then out_apername='FGS1_FULL_OSS'
	if n_elements(redo) ne 1 then redo=0
	if n_elements(verbose) ne 1 then verbose=0
	if n_elements(debug) ne 1 then debug=0
	rcs_id="$Id: jwst_dither_to_sam.pro,v 1.3 2018/03/15 17:38:58 penton Exp penton $"

	uSI=strupcase(strtrim(si,2))
	uSI=(uSI eq 'NRC' ? 'NIRCAM' : uSI)

	<span class="comments">; get siaf</span>

	siaf_info=jwst_read_si_siaf(si,verbose=verbose,debug=debug,redo=redo)
	if verbose then help,siaf_info,/str
	v00=jwst_si_xyidl_to_v23([0,0],si,apername,v2ref=0,v3ref=0,verbose=verbose)
	v00v23=v00.v23
	f00=jwst_si_v23_to_xyidl(v00.v23,out_si,out_apername,v2ref=0,v3ref=0,verbose=verbose)
	f00xy=f00.xyidl
	<span class="comments">;</span>
	<span class="comments">; 1) Convert the dither from NIRCAM [X,Y] to [v2,v3]</span>
	<span class="comments">;</span>
	if verbose then help,apername,out_apername
	v23=jwst_si_xyidl_to_v23(dither,uSI,apername,v2ref=0,v3ref=0,verbose=verbose)
	if verbose then message,/info,'Commanded DITHER in [V2,V3] = ['+string1f(v23.v2,format=FF)+','+string1f(v23.v3,format=FF)+']""'
	f23=jwst_si_v23_to_xyidl([v23.v2,v23.v3],out_SI,out_apername,v2ref=0,v3ref=0,verbose=verbose)
	<span class="comments">;</span>
	<span class="comments">; 2) Translate the dither from [v2,v3] to FGS [X,Y]</span>
	<span class="comments">;</span>
	if verbose then message,/info,'Commanded DITHER in FGS [Xidl,Yidl] = ['+string1f(f23.xidl,format=FF)+','+string1f(f23.yidl,format=FF)+']""'
	SAM_Calculated=f23.xyidl
	sam={si:si,uSI:uSI,apername:apername,dither:dither,siaf_info:siaf_info,$
		sam_calculated:SAM_Calculated,V23:v23,f23:f23,out_si:out_si,out_apername:out_apername}
	return,sam
end
</code>
    </div>
  </body>
</html>